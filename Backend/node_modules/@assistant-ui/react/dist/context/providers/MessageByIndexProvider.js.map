{"version":3,"sources":["../../../src/context/providers/MessageByIndexProvider.tsx"],"sourcesContent":["\"use client\";\n\nimport { useMemo, type FC, type PropsWithChildren } from \"react\";\nimport {\n  AssistantApi,\n  AssistantProvider,\n  useAssistantApi,\n  createAssistantApiField,\n} from \"../react/AssistantApiContext\";\nimport {\n  checkEventScope,\n  normalizeEventSelector,\n} from \"../../types/EventTypes\";\n\nexport const MessageByIndexProvider: FC<\n  PropsWithChildren<{\n    index: number;\n  }>\n> = ({ index, children }) => {\n  const api = useAssistantApi();\n  const api2 = useMemo(() => {\n    const getMessage = () => api.thread().message({ index });\n    return {\n      message: createAssistantApiField({\n        source: \"thread\",\n        query: { type: \"index\", index },\n        get: () => getMessage(),\n      }),\n      composer: createAssistantApiField({\n        source: \"message\",\n        query: {},\n        get: () => getMessage().composer,\n      }),\n      on(selector, callback) {\n        const { event, scope } = normalizeEventSelector(selector);\n        if (\n          !checkEventScope(\"composer\", scope, event) &&\n          !checkEventScope(\"message\", scope, event)\n        )\n          return api.on(selector, callback);\n\n        return api.on({ scope: \"thread\", event }, (e) => {\n          if (e.messageId === getMessage().getState().id) {\n            callback(e);\n          }\n        });\n      },\n    } satisfies Partial<AssistantApi>;\n  }, [api, index]);\n\n  return <AssistantProvider api={api2}>{children}</AssistantProvider>;\n};\n"],"mappings":";;;AAEA,SAAS,eAAgD;AACzD;AAAA,EAEE;AAAA,EACA;AAAA,EACA;AAAA,OACK;AACP;AAAA,EACE;AAAA,EACA;AAAA,OACK;AAsCE;AApCF,IAAM,yBAIT,CAAC,EAAE,OAAO,SAAS,MAAM;AAC3B,QAAM,MAAM,gBAAgB;AAC5B,QAAM,OAAO,QAAQ,MAAM;AACzB,UAAM,aAAa,MAAM,IAAI,OAAO,EAAE,QAAQ,EAAE,MAAM,CAAC;AACvD,WAAO;AAAA,MACL,SAAS,wBAAwB;AAAA,QAC/B,QAAQ;AAAA,QACR,OAAO,EAAE,MAAM,SAAS,MAAM;AAAA,QAC9B,KAAK,MAAM,WAAW;AAAA,MACxB,CAAC;AAAA,MACD,UAAU,wBAAwB;AAAA,QAChC,QAAQ;AAAA,QACR,OAAO,CAAC;AAAA,QACR,KAAK,MAAM,WAAW,EAAE;AAAA,MAC1B,CAAC;AAAA,MACD,GAAG,UAAU,UAAU;AACrB,cAAM,EAAE,OAAO,MAAM,IAAI,uBAAuB,QAAQ;AACxD,YACE,CAAC,gBAAgB,YAAY,OAAO,KAAK,KACzC,CAAC,gBAAgB,WAAW,OAAO,KAAK;AAExC,iBAAO,IAAI,GAAG,UAAU,QAAQ;AAElC,eAAO,IAAI,GAAG,EAAE,OAAO,UAAU,MAAM,GAAG,CAAC,MAAM;AAC/C,cAAI,EAAE,cAAc,WAAW,EAAE,SAAS,EAAE,IAAI;AAC9C,qBAAS,CAAC;AAAA,UACZ;AAAA,QACF,CAAC;AAAA,MACH;AAAA,IACF;AAAA,EACF,GAAG,CAAC,KAAK,KAAK,CAAC;AAEf,SAAO,oBAAC,qBAAkB,KAAK,MAAO,UAAS;AACjD;","names":[]}