{"version":3,"sources":["../../../src/legacy-runtime/client/ThreadListItemRuntimeClient.ts"],"sourcesContent":["import { resource, tapEffect } from \"@assistant-ui/tap\";\nimport {\n  ThreadListItemEventType,\n  ThreadListItemRuntime,\n} from \"../runtime/ThreadListItemRuntime\";\nimport { Unsubscribe } from \"../../types\";\nimport { tapApi } from \"../../utils/tap-store\";\nimport { tapSubscribable } from \"../util-hooks/tapSubscribable\";\nimport { tapEvents } from \"../../client/EventContext\";\nimport { ThreadListItemClientApi } from \"../../client/types/ThreadListItem\";\n\nexport const ThreadListItemClient = resource(\n  ({ runtime }: { runtime: ThreadListItemRuntime }) => {\n    const runtimeState = tapSubscribable(runtime);\n    const events = tapEvents();\n\n    // Bind thread list item events to event manager\n    tapEffect(() => {\n      const unsubscribers: Unsubscribe[] = [];\n\n      // Subscribe to thread list item events\n      const threadListItemEvents: ThreadListItemEventType[] = [\n        \"switched-to\",\n        \"switched-away\",\n      ];\n\n      for (const event of threadListItemEvents) {\n        const unsubscribe = runtime.unstable_on(event, () => {\n          events.emit(`thread-list-item.${event}`, {\n            threadId: runtime.getState()!.id,\n          });\n        });\n        unsubscribers.push(unsubscribe);\n      }\n\n      return () => {\n        for (const unsub of unsubscribers) unsub();\n      };\n    }, [runtime, events]);\n\n    return tapApi<ThreadListItemClientApi>(\n      {\n        getState: () => runtimeState,\n        switchTo: runtime.switchTo,\n        rename: runtime.rename,\n        archive: runtime.archive,\n        unarchive: runtime.unarchive,\n        delete: runtime.delete,\n        generateTitle: runtime.generateTitle,\n        initialize: runtime.initialize,\n        detach: runtime.detach,\n        __internal_getRuntime: () => runtime,\n      },\n      {\n        key: runtimeState.id,\n      },\n    );\n  },\n);\n"],"mappings":";AAAA,SAAS,UAAU,iBAAiB;AAMpC,SAAS,cAAc;AACvB,SAAS,uBAAuB;AAChC,SAAS,iBAAiB;AAGnB,IAAM,uBAAuB;AAAA,EAClC,CAAC,EAAE,QAAQ,MAA0C;AACnD,UAAM,eAAe,gBAAgB,OAAO;AAC5C,UAAM,SAAS,UAAU;AAGzB,cAAU,MAAM;AACd,YAAM,gBAA+B,CAAC;AAGtC,YAAM,uBAAkD;AAAA,QACtD;AAAA,QACA;AAAA,MACF;AAEA,iBAAW,SAAS,sBAAsB;AACxC,cAAM,cAAc,QAAQ,YAAY,OAAO,MAAM;AACnD,iBAAO,KAAK,oBAAoB,KAAK,IAAI;AAAA,YACvC,UAAU,QAAQ,SAAS,EAAG;AAAA,UAChC,CAAC;AAAA,QACH,CAAC;AACD,sBAAc,KAAK,WAAW;AAAA,MAChC;AAEA,aAAO,MAAM;AACX,mBAAW,SAAS,cAAe,OAAM;AAAA,MAC3C;AAAA,IACF,GAAG,CAAC,SAAS,MAAM,CAAC;AAEpB,WAAO;AAAA,MACL;AAAA,QACE,UAAU,MAAM;AAAA,QAChB,UAAU,QAAQ;AAAA,QAClB,QAAQ,QAAQ;AAAA,QAChB,SAAS,QAAQ;AAAA,QACjB,WAAW,QAAQ;AAAA,QACnB,QAAQ,QAAQ;AAAA,QAChB,eAAe,QAAQ;AAAA,QACvB,YAAY,QAAQ;AAAA,QACpB,QAAQ,QAAQ;AAAA,QAChB,uBAAuB,MAAM;AAAA,MAC/B;AAAA,MACA;AAAA,QACE,KAAK,aAAa;AAAA,MACpB;AAAA,IACF;AAAA,EACF;AACF;","names":[]}