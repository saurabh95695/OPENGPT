// src/hooks/tap-effect.ts
import { getCurrentResourceFiber } from "../core/execution-context.js";
function getEffectCell() {
  const fiber = getCurrentResourceFiber();
  const index = fiber.currentIndex++;
  if (!fiber.isFirstRender && index >= fiber.cells.length) {
    throw new Error(
      "Rendered more hooks than during the previous render. Hooks must be called in the exact same order in every render."
    );
  }
  if (!fiber.cells[index]) {
    const cell2 = {
      type: "effect",
      mounted: false
    };
    fiber.cells[index] = cell2;
  }
  const cell = fiber.cells[index];
  if (cell.type !== "effect") {
    throw new Error("Hook order changed between renders");
  }
  return index;
}
function tapEffect(effect, deps) {
  const fiber = getCurrentResourceFiber();
  const cellIndex = getEffectCell();
  fiber.renderContext.commitTasks.push({
    effect,
    deps,
    cellIndex
  });
}
export {
  tapEffect
};
//# sourceMappingURL=tap-effect.js.map