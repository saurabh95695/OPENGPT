// src/hooks/tap-resource.ts
import { tapEffect } from "./tap-effect.js";
import {
  createResourceFiber,
  unmountResource,
  renderResource,
  commitResource
} from "../core/ResourceFiber.js";
import { tapMemo } from "./tap-memo.js";
import { tapState } from "./tap-state.js";
function tapResource(element, deps) {
  const [stateVersion, rerender] = tapState({});
  const fiber = tapMemo(
    () => createResourceFiber(element.type, () => rerender({})),
    [element.type]
  );
  const props = deps ? tapMemo(() => element.props, deps) : element.props;
  const result = tapMemo(
    () => renderResource(fiber, props),
    [fiber, props, stateVersion]
  );
  tapEffect(() => {
    return () => unmountResource(fiber);
  }, [fiber]);
  tapEffect(() => {
    commitResource(fiber, result);
  }, [fiber, result]);
  return result.state;
}
export {
  tapResource
};
//# sourceMappingURL=tap-resource.js.map